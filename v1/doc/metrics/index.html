<!doctype html>
<html lang="en">
 <head> 
  <meta charset="UTF-8"> 
  <meta http-equiv="X-UA-Compatible" content="IE=edge"> 
  <title>jooby: metrics module</title> 
  <meta name="description" content="Scalable, fast and modular micro web framework for Java. Build small/large apps easily and quickly with Netty, Undertow or Jetty."> 
  <meta name="keywords" content="Java, Micro Web Framework, Async, Easy to use, Micro, Sinatra, Express, Scalable, Modern, Best, Web, Framework, Lightweight, Microservices, metrics"> 
  <meta name="viewport" content="width=device-width, initial-scale=1.0"> 
  <link rel="canonical" href="#"> 
  <link rel="publisher" href="#"> 
  <meta name="robots" content="robots.txt"> 
  <meta name="og:title" content="jooby: metrics module"> 
  <meta name="og:description" content="Metrics provides a powerful toolkit of ways to measure the behavior of critical components in your production environment"> 
  <!--
    og:type
    SI EL TEMPLATE ES UN ARTICULO (NOTA, VIDEO, ETC) CAMBIAR
    "website" por "article"
    --> 
  <meta name="og:type" content="website"> 
  <meta name="og:url" content="https://jooby.org"> 
  <!--
    og:image
    SI ES UNA NOTA Y LA NOTA TIENE UNA IMAGEN DE PREVIEW SE DEBE
    CAMBIAR POR UNA IMAGEN CON LAS SIGUIENTES ESPECIFICACIONES
    ANCHO: 200
    ALTO: 200
    FORMATO: JPG
    --> 
  <meta name="og:image" content="https://jooby.org/resources/images/apps/facebook.jpg"> 
  <meta name="og:site_name" content="jooby: metrics module"> 
  <meta name="twitter:card" content="summary"> 
  <meta name="twitter:title" content="jooby: metrics module"> 
  <!--
    twitter:image
    SI ES UNA NOTA Y LA NOTA TIENE UNA IMAGEN DE PREVIEW SE DEBE
    CAMBIAR POR UNA IMAGEN CON LAS SIGUIENTES ESPECIFICACIONES
    ANCHO: 280
    ALTO: 150
    FORMATO: JPG
    TAMAÑO MAXIMO: 1MB
    --> 
  <meta name="twitter:image" content="https://jooby.org/resources/images/apps/twitter.jpg"> 
  <meta name="twitter:site" content="@joobyproject"> 
  <meta name="twitter:creator" content="https://twitter.com/edgarespina"> 
  <meta name="twitter:domain" content="https://jooby.org"> 
  <meta name="twitter:url" content="https://twitter.com/joobyproject"> 
  <meta name="twitter:description" content="Metrics provides a powerful toolkit of ways to measure the behavior of critical components in your production environment"> 
  <link rel="apple-touch-icon-precomposed" href="/v1/resources/images/apps/precomposed57.png" sizes="57x57"> 
  <link rel="apple-touch-icon-precomposed" href="/v1/resources/images/apps/precomposed60.png" sizes="60x60"> 
  <link rel="apple-touch-icon-precomposed" href="/v1/resources/images/apps/precomposed72.png" sizes="72x72"> 
  <link rel="apple-touch-icon-precomposed" href="/v1/resources/images/apps/precomposed76.png" sizes="76x76"> 
  <link rel="apple-touch-icon-precomposed" href="/v1/resources/images/apps/precomposed114.png" sizes="114x114"> 
  <link rel="apple-touch-icon-precomposed" href="/v1/resources/images/apps/precomposed120.png" sizes="120x120"> 
  <link rel="apple-touch-icon-precomposed" href="/v1/resources/images/apps/precomposed144.png" sizes="144x144"> 
  <link rel="apple-touch-icon-precomposed" href="/v1/resources/images/apps/precomposed152.png" sizes="152x152"> 
  <link rel="apple-touch-icon-precomposed" href="/v1/resources/images/apps/precomposed180.png" sizes="180x180"> 
  <link href="/v1/resources/images/apps/favicon.ico" rel="shortcut icon"> 
  <link href="/v1/resources/images/apps/favicon.png" rel="icon" sizes="16x16" type="image/png"> 
  <link href="/v1/resources/images/apps/favicon32.png" rel="icon" sizes="32x32" type="image/png"> 
  <link href="/v1/resources/images/apps/favicon96.png" rel="icon" sizes="96x96" type="image/png"> 
  <link href="/v1/resources/images/apps/android-chrome.png" rel="icon" sizes="192x192" type="image/png"> 
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Raleway:400,300,500,700"> 
  <link rel="stylesheet" href="/v1/resources/styles/application.css"> 
  <link rel="stylesheet" href="/v1/resources/styles/github.css"> 
  <link rel="stylesheet" href="/v1/resources/styles/devices.css"> 
  <link rel="stylesheet" href="/v1/resources/styles/sprites.css"> 
 </head> 
 <body class="page-section page-sidebar"> 
  <header class="site-header"> 
   <div class="row"> 
    <a href="/v1/" title="Home" class="site-logo"><img src="resources/images/logo_jooby-2x.png" alt="Logo Jooby" width="76" height="31"></a> 
    <a class="show-mobile open-menu" href="/v1"><span></span></a> 
    <nav class="site-nav"> 
     <ul> 
      <li class=""><a href="/v1/quickstart" title="Quick start">QUICK START</a></li> 
      <li class=""><a href="/v1/doc" title="Doc">DOCS</a></li> 
      <li class="active"><a href="/v1/modules" title="Modules">MODULES</a></li> 
      <li class=""><a href="/v1/community" title="Community">COMMUNITY</a></li> 
      <li class=""><a href="/v1/faq" title="FAQ">FAQ</a></li> 
      <li><a href="https://javadoc.io/doc/org.jooby/jooby/1.6.6" target="_blank" title="API docs">API DOCS</a></li> 
     </ul> 
    </nav> 
   </div> 
  </header> 
  <main role="main" class="site-content"> 
   <div class="section-title"> 
    <div class="row"> 
     <a href="/v1/modules" class="jsback" title="Go back"><span class="icon-arrowback-big-circle"></span></a> 
     <h1>metrics</h1> 
    </div> 
   </div> 
   <div class="row"> 
    <div class="section-sidebar" style="position: fixed; left: 120px; top: 160px; bottom: 20px;"> 
     <div class="show-mobile menu-open">
       metrics 
     </div> 
     <ul> 
      <li class="active"> <a href="#metrics">metrics</a> 
       <ul> 
        <li> <a href="#metrics-dependency">dependency</a></li> 
        <li> <a href="#metrics-usage">usage</a></li> 
        <li> <a href="#metrics-metrics">metrics</a></li> 
        <li> <a href="#metrics-health-checks">health checks</a></li> 
        <li> <a href="#metrics-instrumented-requests">instrumented requests</a></li> 
        <li> <a href="#metrics-thread-dump">thread dump</a></li> 
        <li> <a href="#metrics-reporting">reporting</a></li> 
       </ul></li> 
     </ul> 
    </div> 
    <div class="section-content"> 
     <div class="datalist" id="metrics"> 
      <div class="datalist-title active"> 
       <h2>metrics</h2> 
      </div> 
      <div class="datalist-content"> 
       <p><a href="http://metrics.dropwizard.io" target="_blank">Metrics</a> provides a powerful toolkit of ways to measure the behavior of critical components in your production environment.</p> 
       <h3 id="metrics-dependency">dependency</h3> 
       <div class="highlighter-rouge codehilite"> 
        <div class="copy-bar"> 
         <span class="icon-clipboard-big copy-button octicon octicon-clippy" title="copy to clipboard"></span> 
        </div> 
        <pre class="highlight"><code><span class="nt">&lt;dependency&gt;</span>
  <span class="nt">&lt;groupId&gt;</span>org.jooby<span class="nt">&lt;/groupId&gt;</span>
  <span class="nt">&lt;artifactId&gt;</span>jooby-metrics<span class="nt">&lt;/artifactId&gt;</span>
  <span class="nt">&lt;version&gt;</span>1.6.6<span class="nt">&lt;/version&gt;</span>
<span class="nt">&lt;/dependency&gt;</span>
</code></pre> 
       </div> 
       <h3 id="metrics-usage">usage</h3> 
       <div class="highlighter-rouge codehilite"> 
        <div class="copy-bar"> 
         <span class="icon-clipboard-big copy-button octicon octicon-clippy" title="copy to clipboard"></span> 
        </div> 
        <pre class="highlight"><code><span class="o">{</span>
 <span class="n">use</span><span class="o">(</span><span class="k">new</span> <span class="n">Metrics</span><span class="o">()</span>
    <span class="o">.</span><span class="na">request</span><span class="o">()</span>
    <span class="o">.</span><span class="na">threadDump</span><span class="o">()</span>
    <span class="o">.</span><span class="na">ping</span><span class="o">()</span>
    <span class="o">.</span><span class="na">healthCheck</span><span class="o">(</span><span class="s">"db"</span><span class="o">,</span> <span class="k">new</span> <span class="n">DatabaseHealthCheck</span><span class="o">())</span>
    <span class="o">.</span><span class="na">metric</span><span class="o">(</span><span class="s">"memory"</span><span class="o">,</span> <span class="k">new</span> <span class="n">MemoryUsageGaugeSet</span><span class="o">())</span>
    <span class="o">.</span><span class="na">metric</span><span class="o">(</span><span class="s">"threads"</span><span class="o">,</span> <span class="k">new</span> <span class="n">ThreadStatesGaugeSet</span><span class="o">())</span>
    <span class="o">.</span><span class="na">metric</span><span class="o">(</span><span class="s">"gc"</span><span class="o">,</span> <span class="k">new</span> <span class="n">GarbageCollectorMetricSet</span><span class="o">())</span>
    <span class="o">.</span><span class="na">metric</span><span class="o">(</span><span class="s">"fs"</span><span class="o">,</span> <span class="k">new</span> <span class="n">FileDescriptorRatioGauge</span><span class="o">())</span>
    <span class="o">);</span>
<span class="o">}</span>
</code></pre> 
       </div> 
       <p>Let’s see what all these means.</p> 
       <h3 id="metrics-metrics">metrics</h3> 
       <p>Metrics are available at <code class="highlighter-rouge codehilite">/sys/metrics</code> or <code class="highlighter-rouge codehilite">/sys/metrics/:type</code> via:</p> 
       <div class="highlighter-rouge codehilite"> 
        <div class="copy-bar"> 
         <span class="icon-clipboard-big copy-button octicon octicon-clippy" title="copy to clipboard"></span> 
        </div> 
        <pre class="highlight"><code> <span class="n">use</span><span class="o">(</span><span class="k">new</span> <span class="n">Metrics</span><span class="o">()</span>
    <span class="o">.</span><span class="na">metric</span><span class="o">(</span><span class="s">"memory"</span><span class="o">,</span> <span class="k">new</span> <span class="n">MemoryUsageGaugeSet</span><span class="o">())</span>
    <span class="o">.</span><span class="na">metric</span><span class="o">(</span><span class="s">"threads"</span><span class="o">,</span> <span class="k">new</span> <span class="n">ThreadStatesGaugeSet</span><span class="o">())</span>
    <span class="o">.</span><span class="na">metric</span><span class="o">(</span><span class="s">"gc"</span><span class="o">,</span> <span class="k">new</span> <span class="n">GarbageCollectorMetricSet</span><span class="o">())</span>
    <span class="o">.</span><span class="na">metric</span><span class="o">(</span><span class="s">"fs"</span><span class="o">,</span> <span class="k">new</span> <span class="n">FileDescriptorRatioGauge</span><span class="o">()));</span>
</code></pre> 
       </div> 
       <p>The <code class="highlighter-rouge codehilite">/:type</code> parameter is optional and let you filter metrics by type <code class="highlighter-rouge codehilite">counters</code>, <code class="highlighter-rouge codehilite">guages</code>, etc..</p> 
       <p>There is a <code class="highlighter-rouge codehilite">name</code> filter too: <code class="highlighter-rouge codehilite">/sys/metrics?name=memory</code> or <code class="highlighter-rouge codehilite">/sys/metrics/guages?name=memory</code>. The <code class="highlighter-rouge codehilite">name</code> parameter filter all the metrics where the name starts with the given <code class="highlighter-rouge codehilite">name</code>.</p> 
       <h3 id="metrics-health-checks">health checks</h3> 
       <p>Health checks are available at <code class="highlighter-rouge codehilite">/sys/healthCheck</code> via:</p> 
       <div class="highlighter-rouge codehilite"> 
        <div class="copy-bar"> 
         <span class="icon-clipboard-big copy-button octicon octicon-clippy" title="copy to clipboard"></span> 
        </div> 
        <pre class="highlight"><code> <span class="n">use</span><span class="o">(</span><span class="k">new</span> <span class="n">Metrics</span><span class="o">()</span>
    <span class="o">.</span><span class="na">healthCheck</span><span class="o">(</span><span class="s">"db"</span><span class="o">,</span> <span class="k">new</span> <span class="n">DatabaseHealthCheck</span><span class="o">()));</span>
</code></pre> 
       </div> 
       <h3 id="metrics-instrumented-requests">instrumented requests</h3> 
       <p>Captures request information (like active requests or min/mean/max execution time) and a breakdown of the response codes being returned: <a href="/v1/apidocs/org/jooby/assets/InstrumentedHandler.html" target="_blank">InstrumentedHandler</a>.</p> 
       <div class="highlighter-rouge codehilite"> 
        <div class="copy-bar"> 
         <span class="icon-clipboard-big copy-button octicon octicon-clippy" title="copy to clipboard"></span> 
        </div> 
        <pre class="highlight"><code> <span class="n">use</span><span class="o">(</span><span class="k">new</span> <span class="n">Metrics</span><span class="o">()</span>
    <span class="o">.</span><span class="na">request</span><span class="o">());</span>
</code></pre> 
       </div> 
       <h3 id="metrics-thread-dump">thread dump</h3> 
       <p>A thread dump is available at <code class="highlighter-rouge codehilite">/sys/threadDump</code> via:</p> 
       <div class="highlighter-rouge codehilite"> 
        <div class="copy-bar"> 
         <span class="icon-clipboard-big copy-button octicon octicon-clippy" title="copy to clipboard"></span> 
        </div> 
        <pre class="highlight"><code> <span class="n">use</span><span class="o">(</span><span class="k">new</span> <span class="n">Metrics</span><span class="o">()</span>
    <span class="o">.</span><span class="na">threadDump</span><span class="o">());</span>
</code></pre> 
       </div> 
       <h3 id="metrics-reporting">reporting</h3> 
       <p>Reporters are appended via a callback API:</p> 
       <div class="highlighter-rouge codehilite"> 
        <div class="copy-bar"> 
         <span class="icon-clipboard-big copy-button octicon octicon-clippy" title="copy to clipboard"></span> 
        </div> 
        <pre class="highlight"><code> <span class="o">{</span>
   <span class="n">use</span><span class="o">(</span><span class="k">new</span> <span class="n">Metrics</span><span class="o">()</span>
      <span class="o">.</span><span class="na">reporter</span><span class="o">(</span><span class="n">registry</span> <span class="o">-&gt;</span> <span class="o">{</span>
        <span class="n">ConsoleReporter</span> <span class="n">reporter</span> <span class="o">=</span> <span class="n">ConsoleReporter</span><span class="o">.</span><span class="na">forRegistry</span><span class="o">(</span><span class="n">registry</span><span class="o">).</span><span class="na">build</span><span class="o">();</span>
        <span class="n">reporter</span><span class="o">.</span><span class="na">start</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="n">TimeUnit</span><span class="o">.</span><span class="na">MINUTES</span><span class="o">);</span>
        <span class="k">return</span> <span class="n">reporter</span><span class="o">;</span>
      <span class="o">});</span>
 <span class="o">}</span>
</code></pre> 
       </div> 
       <p>You can add all the reporters you want. Keep in mind you have to start them (if need it), but you don’t have to stop them as long they implements the <a href="/v1/apidocs/org/jooby/assets/Closeable.html" target="_blank">Closeable</a> interface.</p> 
      </div> 
     </div> 
    </div> 
   </div> 
  </main> 
  <footer class="site-footer"> 
   <div class="row"> 
    <p class="pull-left">©2014-2019 <a href="https://twitter.com/joobyproject" target="_blank">The Jooby Project</a>, all rights reserved.</p> 
    <div class="follow-us pull-right"> 
     <p>Follow us</p> 
     <a href="https://github.com/jooby-project/jooby" title="Follow us on Github" target="_blank" rel="nofollow"><span class="icon-github-medium-circle"></span></a> 
     <a href="https://twitter.com/joobyproject" title="Follow us on Twitter" target="_blank" rel="nofollow"><span class="icon-twitter-medium-circle"></span></a> 
    </div> 
   </div> 
  </footer> 
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script> 
  <script>window.jQuery || document.write('<script src="resources/scripts/libs/jquery-2.1.4.min.js"><\/script>')</script> 
  <script src="resources/scripts/libs/swiper.min.js"></script> 
  <script src="resources/scripts/application.js"></script> 
  <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-57151281-1', 'auto');
      ga('send', 'pageview');
    </script>   
 </body>
</html>